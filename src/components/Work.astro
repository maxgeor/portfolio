---
import ScrollingBanner from './ScrollingBanner.astro'

type Roles = {
  long: string[],
  short: string[];
}

type Work = {
  title: string;
  description: string;
  roles: Roles;
  link?: {
    href: string;
    target?: '_blank' | '_self';
  };
  year: string;
  image: string;
  type: string;
  studySlug?: string;
  isPrivate?: boolean;
  isComingSoon?: boolean;
  classes?: string;
}

const { 
  title, 
  description, 
  type,
  image,
  year,
  link = {
    href: null,
    target: '_blank',
  },
  roles,
  studySlug,
  isPrivate = false,
  classes = '',
  isComingSoon = false,
} = Astro.props;

const Element = isComingSoon ? 'div' : 'a';
const props = 
  isComingSoon || isPrivate
    ? {} 
    : studySlug 
      ? { href: `study/${studySlug}`, target: '_self' } 
      : link 
---
<Element
  {...props}
  class={`
    relative group col-span-full sm:col-span-6 md:col-span-4 xl:col-span-3 hover:bg-transparent
    ${isComingSoon || isPrivate ? 'cursor-not-allowed' : props.target === '_blank' ? 'cursor-alias' : 'cursor-pointer'}
    ${classes}
  `}
>
  <div class={`${isComingSoon ? 'text-black/40  hover:text-black' : ''}`}>
    <div>
      <div class="flex justify-between">
        <h2 class="uppercase shrink-0 whitespace-nowrap">
          {title}
        </h2>
        <div class="flex items-center gap-1">
          <div class="flex">
            {studySlug ? <span class="shrink-0 border border-white border-box h-[6px] w-[6px] rounded-full bg-[#ff32b0]"></span> : null}
            {type === "client" ? <span class="shrink-0 border border-white border-box h-[6px] w-[6px] rounded-full bg-[#39c239] -ml-0.5 first:m-0"></span> : null}
            {type === "project" ? <span class="shrink-0 border border-white border-box h-[6px] w-[6px] rounded-full bg-[blue] -ml-0.5 first:m-0"></span> : null}
          </div>
          <span>{isPrivate ? "Private" : isComingSoon ? "Coming Soon" : studySlug ? "More" : "See"}</span>
        </div>
      </div>
      <p>{description}</p>
      <p>{roles.long.join(', ')}</p>
      <p class="capitalize">{type}</p>
      <p>{year}</p>
    </div>
    <picture id="work-pic" class={`relative h-auto  opacity-0 group-hover:opacity-100`}>
      <img
        src={image}
        alt={`Preview mockup of ${title}`}
        class={`
          w-full h-full object-top select-none object-contain 
        `}
      />
      {isComingSoon && <ScrollingBanner title='Coming Soon' classes="-rotate-[12deg]" />}
      {isPrivate && <ScrollingBanner title='Private' classes="-rotate-[12deg]" />}
    </picture>
    <!-- {(isPrivate || isComingSoon) && (
      <div class="h-3 hidden group-hover:flex items-center justify-center group-focus:block">
        <ScrollingBanner title={ isPrivate ? 'Private' : 'Coming Soon'} classes="text-black opacity-1" />
      </div>
    )} -->
  </div>
</Element>