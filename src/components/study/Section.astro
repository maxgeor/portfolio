---
import Caption from './Caption.astro';
import clsx from 'clsx';

export interface Props {
  id: string;
  title: string
  classes?: string;
}

const { id, title, classes = "" } = Astro.props;
---
<section 
  id={id + '-' + title} 
  aria-label={title}
  class={clsx("scroll-mt-[47px] relative grid grid-cols-12 gap-x-4 col-span-full lg:mt-4", classes)}
>
  <div class="grid grid-cols-12 gap-x-4 gap-2 lg:hidden sticky lg:static top-[45px] col-span-full z-[100] -my-0.5 pb-2 mix-blend-difference">
    <Caption id={id} text={title} element="h2" classes='text-pretty text-white' />
  </div>
  <h2 class="hidden lg:flex sticky top-[48px] uppercase text-pretty col-span-2 gap-2 -my-0.5 z-[100] mix-blend-difference text-white">
    <span>{id}</span>
    <span class="">{title}</span>
  </h2>
  <div class="context flex flex-col -my-0.5 [&_mark]:bg-transparent [&_mark]:text-black dark:[&_mark]:text-white [&_mark]:font-bold col-span-full sm:col-span-11 md:col-span-9 lg:col-start-3 lg:col-span-6 xl:col-span-5 2xl:col-span-4 3xl:col-span-3 xl:col-start-3 3xl:max-w-[85ch] h-fit [&>p]:mb-3 last:[&>p]:mb-0">
    <slot name="context" />
  </div>
  {Astro.slots.has('default') && (
    <div class="grid grid-cols-12 gap-y-8 mt-8 col-span-full">
      <slot />
    </div>
  )}
</section>

<style>
  section::after {
    content: '';
    display: block;
    height: 1px;
    margin-bottom: -1px;
  }

  section h2::before,
  section div:first-child::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    backdrop-filter: invert(1);
    z-index: -1;
    transition: opacity 0.3s ease;
    opacity: 0;
  }
</style>